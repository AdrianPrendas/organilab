{% extends 'base.html' %}
{% load i18n shelf_position static %}

{% block title %}{% trans 'Laboratory rooms' %}{% endblock %}

{# Container #}
{% block container %}container-fluid{% endblock %}

{# Content #}
{% block content %}
  <h1 class="text-center">{% get_laboratory_name %}</h1>

  {# Search widget #}
  {% include 'laboratory/search_widget.html' with laboratory=laboratory %}

  {# Nav #}
  <div class="row">
    <div class="col-md-12">
      <ul id="labmenues" class="nav nav-tabs" role="tablist">
        {% for LaboratoryRoom in object_list %}
          <li role="presentation">
            <a id="room_{{ LaboratoryRoom.id }}" href="#idlab"
               data-argument="{{ LaboratoryRoom.id }}"
               onclick="function_name_furniture('{{ LaboratoryRoom.id }}')"
               aria-controls={{ LaboratoryRoom.id }} role="tab"
               data-toggle="tab">{{ LaboratoryRoom.name }}</a>
          </li>
        {% endfor %}
      </ul>
    </div>
  </div>

  {# Furniture panel #}
  <div class="row">
    <div class="col-md-12">
      <div class="tab-content">
        {% for LaboratoryRoom in object_list %}
          <div role="tab-panel" class="tab-pane" id="idlab">
            <div class="col-md-3">
              <div id="furnitures">
              </div>
            </div>

            <div class="col-md-9">
              <div id="shelf">
              </div>
              <div id="prototype_shelf_field" class="hidden">
                <h2>{% trans 'Please click over furniture items' %}<br>
                  <small> {% trans 'Shelves will be displayed here' %} </small>
                </h2>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>

  {% include 'laboratory/shelfobjectUpdate_modal.html' %}
{% endblock %}

{% block js %}
  <script>
    document.furniture_list = '{% url "laboratory:furniture_list" laboratory %}';
    document.shelf_list = '{% url "laboratory:list_shelf" laboratory %}';
    document.shelfobject_list = '{% url "laboratory:list_shelfobject" laboratory %}';
  </script>
  <script src="{% static 'js/shelfobjectedit.js' %}"></script>

  <script>
    (function () {
      $("#labmenues").find("a").first().click();
      see_prototype_shelf_field();
    })();
  </script>

  <script>
  function get_url_parameters(){
	  var params = window.location.href.split("#");
	  if(params.length > 1){
	    params = params[1].split("&");
	  }

	  var obj={};

	  for(var x=0; x<params.length; x++){
	    var tmp = params[x].split("=");
	    console.log(tmp.length);
	    if(tmp.length>1){
	      if(tmp[0]=='labroom') obj['labroom']=tmp[1];
	      if(tmp[0]=='furniture') obj['furniture']=tmp[1];
	      if(tmp[0]=='shelf') obj['shelf']=tmp[1];
	    }
	  }

	  var ok=false;
	  if(obj.labroom !== undefined && obj.furniture !== undefined && obj.shelf !== undefined){
	  ok=true;
	  }
	  if (!ok){
	    obj=undefined;
	  }
	   return obj; 
}
  
  </script>

{% endblock %}